
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>google.cloud.bigquery.magics &#8212; google-cloud 3fc8616 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="google.cloud.bigquery.magics.Context" href="google.cloud.bigquery.magics.Context.html" />
    <link rel="prev" title="google.cloud.bigquery.external_config.GoogleSheetsOptions" href="google.cloud.bigquery.external_config.GoogleSheetsOptions.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-google.cloud.bigquery.magics">
<span id="google-cloud-bigquery-magics"></span><h1>google.cloud.bigquery.magics<a class="headerlink" href="#module-google.cloud.bigquery.magics" title="Permalink to this headline">#</a></h1>
<p>IPython Magics</p>
<dl class="function">
<dt>
<code class="descname">%%bigquery</code></dt>
<dd><p>IPython cell magic to run a query and display the result as a DataFrame</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">bigquery</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">destination_var</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">project</span> <span class="o">&lt;</span><span class="n">project</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">use_legacy_sql</span><span class="p">]</span>
           <span class="p">[</span><span class="o">--</span><span class="n">verbose</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">params</span> <span class="o">&lt;</span><span class="n">params</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">query</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">&lt;destination_var&gt;</span></code> (optional, line argument):</dt>
<dd>variable to store the query results. The results are not displayed if
this parameter is used.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">--project</span> <span class="pre">&lt;project&gt;</span></code> (optional, line argument):</dt>
<dd>Project to use for running the query. Defaults to the context
<a class="reference internal" href="google.cloud.bigquery.magics.Context.html#google.cloud.bigquery.magics.Context.project" title="google.cloud.bigquery.magics.Context.project"><code class="xref py py-attr docutils literal notranslate"><span class="pre">project</span></code></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">--use_legacy_sql</span></code> (optional, line argument):</dt>
<dd>Runs the query using Legacy SQL syntax. Defaults to Standard SQL if
this argument not used.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">--verbose</span></code> (optional, line argument):</dt>
<dd>If this flag is used, information including the query job ID and the
amount of time for the query to complete will not be cleared after the
query is finished. By default, this information will be displayed but
will be cleared after the query is finished.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">--params</span> <span class="pre">&lt;params&gt;</span></code> (optional, line argument):</dt>
<dd>If present, the argument following the <code class="docutils literal notranslate"><span class="pre">--params</span></code> flag must be
either:<ul class="last">
<li><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> - A JSON string representation of a dictionary in the
format <code class="docutils literal notranslate"><span class="pre">{&quot;param_name&quot;:</span> <span class="pre">&quot;param_value&quot;}</span></code> (ex. <code class="docutils literal notranslate"><span class="pre">{&quot;num&quot;:</span> <span class="pre">17}</span></code>). Use
of the parameter in the query should be indicated with
<code class="docutils literal notranslate"><span class="pre">&#64;param_name</span></code>. See <code class="docutils literal notranslate"><span class="pre">In[5]</span></code> in the Examples section below.</li>
<li><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> reference - A reference to a <code class="docutils literal notranslate"><span class="pre">dict</span></code> in the format
<code class="docutils literal notranslate"><span class="pre">{&quot;param_name&quot;:</span> <span class="pre">&quot;param_value&quot;}</span></code>, where the value types must be JSON
serializable. The variable reference is indicated by a <code class="docutils literal notranslate"><span class="pre">$</span></code> before
the variable name (ex. <code class="docutils literal notranslate"><span class="pre">$my_dict_var</span></code>). See <code class="docutils literal notranslate"><span class="pre">In[6]</span></code> and <code class="docutils literal notranslate"><span class="pre">In[7]</span></code>
in the Examples section below.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">&lt;query&gt;</span></code> (required, cell argument):</dt>
<dd>SQL query to run.</dd>
</dl>
</li>
</ul>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.23.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> with the query results.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All queries run using this magic will run using the context
<a class="reference internal" href="google.cloud.bigquery.magics.Context.html#google.cloud.bigquery.magics.Context.credentials" title="google.cloud.bigquery.magics.Context.credentials"><code class="xref py py-attr docutils literal notranslate"><span class="pre">credentials</span></code></a>.</p>
</div>
<dl class="docutils">
<dt>Examples:</dt>
<dd>The following examples can be run in an IPython notebook after loading
the bigquery IPython extension (see <code class="docutils literal notranslate"><span class="pre">In[1]</span></code>) and setting up
Application Default Credentials.</dd>
</dl>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>In [1]: %load_ext google.cloud.bigquery

In [2]: %%bigquery
   ...: SELECT name, SUM(number) as count
   ...: FROM `bigquery-public-data.usa_names.usa_1910_current`
   ...: GROUP BY name
   ...: ORDER BY count DESC
   ...: LIMIT 3

Out[2]:       name    count
   ...: -------------------
   ...: 0    James  4987296
   ...: 1     John  4866302
   ...: 2   Robert  4738204

In [3]: %%bigquery df --project my-alternate-project --verbose
   ...: SELECT name, SUM(number) as count
   ...: FROM `bigquery-public-data.usa_names.usa_1910_current`
   ...: WHERE gender = &#39;F&#39;
   ...: GROUP BY name
   ...: ORDER BY count DESC
   ...: LIMIT 3
Executing query with job ID: bf633912-af2c-4780-b568-5d868058632b
Query executing: 2.61s
Query complete after 2.92s

In [4]: df

Out[4]:          name    count
   ...: ----------------------
   ...: 0        Mary  3736239
   ...: 1    Patricia  1568495
   ...: 2   Elizabeth  1519946

In [5]: %%bigquery --params {&quot;num&quot;: 17}
   ...: SELECT @num AS num

Out[5]:     num
   ...: -------
   ...: 0    17

In [6]: params = {&quot;num&quot;: 17}

In [7]: %%bigquery --params $params
   ...: SELECT @num AS num

Out[7]:     num
   ...: -------
   ...: 0    17
</pre></div>
</div>
</dd></dl>

<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="google.cloud.bigquery.magics.Context.html#google.cloud.bigquery.magics.Context" title="google.cloud.bigquery.magics.Context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Context</span></code></a>()</td>
<td>Storage for objects to be used throughout an IPython notebook session.</td>
</tr>
</tbody>
</table>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">google-cloud</a></h1>



<p class="blurb">Google Cloud Client Libraries for Python</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=GoogleCloudPlatform&repo=google-cloud-python&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core/index.html">Core Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../asset/index.html">Asset Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../automl/index.html">AutoML</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">BigQuery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bigquery_datatransfer/index.html">BigQuery Data-Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bigtable/index.html">Bigtable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../container/index.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataproc/index.html">Dataproc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datastore/index.html">Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dlp/index.html">Data Loss Prevention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dns/index.html">DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../firestore/index.html">Firestore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iam/index.html">IAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iot/index.html">IoT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kms/index.html">Key Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/index.html">Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pubsub/index.html">PubSub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../oslogin/index.html">OSLogin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redis/index.html">Redis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resource-manager/index.html">Resource Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../runtimeconfig/index.html">Python Client for Google Cloud RuntimeConfig</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../runtimeconfig/index.html#api-reference">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scheduler/index.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../securitycenter/index.html">Security Center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../websecurityscanner/index.html">Security Scanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spanner/index.html">Spanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../speech/index.html">Speech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../storage/index.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tasks/index.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../texttospeech/index.html">Text-to-Speech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translate/index.html">Translate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vision/index.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../videointelligence/index.html">Video Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../error-reporting/index.html">Stackdriver Error Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging/index.html">Stackdriver Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../monitoring/index.html">Stackdriver Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Stackdriver Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases.html">Release History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Python Client for Google BigQuery</a><ul>
  <li><a href="../reference.html">API Reference</a><ul>
      <li>Previous: <a href="google.cloud.bigquery.external_config.GoogleSheetsOptions.html" title="previous chapter">google.cloud.bigquery.external_config.GoogleSheetsOptions</a></li>
      <li>Next: <a href="google.cloud.bigquery.magics.Context.html" title="next chapter">google.cloud.bigquery.magics.Context</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014-2017, Google.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/bigquery/generated/google.cloud.bigquery.magics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/GoogleCloudPlatform/google-cloud-python" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>